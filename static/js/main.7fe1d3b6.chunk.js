(this.webpackJsonpcomp=this.webpackJsonpcomp||[]).push([[0],{24:function(e,t,n){},25:function(e,t,n){},35:function(e,t,n){"use strict";function i(e){function t(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+" in simple mode")}function n(e,t){if(!e)return/(?:)/;var n="";return e instanceof RegExp?(e.ignoreCase&&(n="i"),e=e.source):e=String(e),new RegExp((!1===t?"":"^")+"(?:"+e+")",n)}function i(e,i){(e.next||e.push)&&t(i,e.next||e.push),this.regex=n(e.regex),this.token=function(e){if(!e)return null;if(e.apply)return e;if("string"==typeof e)return e.replace(/\./g," ");for(var t=[],n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}(e.token),this.data=e}function r(e,t){return function(n,i){if(i.pending){var r=i.pending.shift();return 0==i.pending.length&&(i.pending=null),n.pos+=r.text.length,r.token}if(i.local){if(i.local.end&&n.match(i.local.end)){var s=i.local.endToken||null;return i.local=i.localState=null,s}var o;s=i.local.mode.token(n,i.localState);return i.local.endScan&&(o=i.local.endScan.exec(n.current()))&&(n.pos=n.start+o.index),s}for(var l=e[i.state],c=0;c<l.length;c++){var u=l[c],x=(!u.data.sol||n.sol())&&n.match(u.regex);if(x){u.data.next?i.state=u.data.next:u.data.push?((i.stack||(i.stack=[])).push(i.state),i.state=u.data.push):u.data.pop&&i.stack&&i.stack.length&&(i.state=i.stack.pop()),u.data.mode&&a(t,i,u.data.mode,u.token),u.data.indent&&i.indent.push(n.indentation()+t.indentUnit),u.data.dedent&&i.indent.pop();var d=u.token;if(d&&d.apply&&(d=d(x)),x.length>2&&u.token&&"string"!=typeof u.token){i.pending=[];for(var h=2;h<x.length;h++)x[h]&&i.pending.push({text:x[h],token:u.token[h-1]});return n.backUp(x[0].length-(x[1]?x[1].length:0)),d[0]}return d&&d.join?d[0]:d}}return n.next(),null}}function s(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=0;for(var i in e)if(e.hasOwnProperty(i)){if(!t.hasOwnProperty(i)||!s(e[i],t[i]))return!1;n++}for(var i in t)t.hasOwnProperty(i)&&n--;return 0==n}function a(t,i,r,a){var o;if(r.persistent)for(var l=i.persistentStates;l&&!o;l=l.next)(r.spec?s(r.spec,l.spec):r.mode==l.mode)&&(o=l);var c=o?o.mode:r.mode||e.getMode(t,r.spec),u=o?o.state:e.startState(c);r.persistent&&!o&&(i.persistentStates={mode:c,spec:r.spec,state:u,next:i.persistentStates}),i.localState=u,i.local={mode:c,end:r.end&&n(r.end),endScan:r.end&&!1!==r.forceEnd&&n(r.end,!1),endToken:a&&a.join?a[a.length-1]:a}}function o(t,n){return function(i,r,s){if(i.local&&i.local.mode.indent)return i.local.mode.indent(i.localState,r,s);if(null==i.indent||i.local||n.dontIndentStates&&function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0}(i.state,n.dontIndentStates)>-1)return e.Pass;var a=i.indent.length-1,o=t[i.state];e:for(;;){for(var l=0;l<o.length;l++){var c=o[l];if(c.data.dedent&&!1!==c.data.dedentIfLineStart){var u=c.regex.exec(r);if(u&&u[0]){a--,(c.next||c.push)&&(o=t[c.next||c.push]),r=r.slice(u[0].length);continue e}}}break}return a<0?0:i.indent[a]}}e.defineSimpleMode=function(t,n){e.defineMode(t,(function(t){return e.simpleMode(t,n)}))},e.simpleMode=function(n,s){t(s,"start");var a={},l=s.meta||{},c=!1;for(var u in s)if(u!=l&&s.hasOwnProperty(u))for(var x=a[u]=[],d=s[u],h=0;h<d.length;h++){var p=d[h];x.push(new i(p,s)),(p.indent||p.dedent)&&(c=!0)}var g={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:c?[]:null}},copyState:function(t){var n={state:t.state,pending:t.pending,local:t.local,localState:null,indent:t.indent&&t.indent.slice(0)};t.localState&&(n.localState=e.copyState(t.local.mode,t.localState)),t.stack&&(n.stack=t.stack.slice(0));for(var i=t.persistentStates;i;i=i.next)n.persistentStates={mode:i.mode,spec:i.spec,state:i.state==t.localState?n.localState:e.copyState(i.mode,i.state),next:n.persistentStates};return n},token:r(a,n),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:o(a,l)};if(l)for(var f in l)l.hasOwnProperty(f)&&(g[f]=l[f]);return g}}n.r(t),n.d(t,"addDefineSimpleMode",(function(){return i}))},36:function(e,t,n){"use strict";n.r(t);var i,r=n(3),s=n.n(r),a=n(17),o=n.n(a),l=(n(24),n(16)),c=n(14),u=n(2),x=n(15),d=n(4),h=n(10),p=n(11),g=(n(25),n(18)),f=(n(27),n(28),n(29),n(7)),b=n.n(f),m=n(19),_=n(9),v=n.n(_),w=n(13),y=new Array(32).fill(void 0);function k(e){return y[e]}y.push(void 0,null,!0,!1);var j=y.length;function O(e){var t=k(e);return function(e){e<36||(y[e]=j,j=e)}(e),t}var S=null;function z(){return null!==S&&S.buffer===i.memory.buffer||(S=new Uint32Array(i.memory.buffer)),S}var A=0;function T(e,t){var n=t(4*e.length);return z().set(e,n/4),A=e.length,n}var N=null;function C(){return null!==N&&N.buffer===i.memory.buffer||(N=new Int32Array(i.memory.buffer)),N}var L=null;function D(){return null!==L&&L.buffer===i.memory.buffer||(L=new Uint8Array(i.memory.buffer)),L}function M(e,t,n,r,s){try{var a=i.__wbindgen_add_to_stack_pointer(-16),o=T(e,i.__wbindgen_malloc),l=A,c=T(t,i.__wbindgen_malloc),u=A;i.perform_simulation(a,o,l,c,u,n,r,s);var x=C()[a/4+0],d=C()[a/4+1],h=(p=x,g=d,D().subarray(p/1,p/1+g)).slice();return i.__wbindgen_free(x,1*d),h}finally{i.__wbindgen_add_to_stack_pointer(16)}var p,g}function B(){try{var e=i.__wbindgen_add_to_stack_pointer(-16);i.get_indices(e);var t=C()[e/4+0],n=C()[e/4+1],r=(s=t,a=n,z().subarray(s/4,s/4+a)).slice();return i.__wbindgen_free(t,4*n),r}finally{i.__wbindgen_add_to_stack_pointer(16)}var s,a}var R=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});function q(e,t){return R.decode(D().subarray(e,e+t))}function I(e){j===y.length&&y.push(y.length+1);var t=j;return j=y[t],y[t]=e,t}R.decode();var E=new TextEncoder("utf-8"),P="function"===typeof E.encodeInto?function(e,t){return E.encodeInto(e,t)}:function(e,t){var n=E.encode(e);return t.set(n),{read:e.length,written:n.length}};function W(e,t,n){if(void 0===n){var i=E.encode(e),r=t(i.length);return D().subarray(r,r+i.length).set(i),A=i.length,r}for(var s=e.length,a=t(s),o=D(),l=0;l<s;l++){var c=e.charCodeAt(l);if(c>127)break;o[a+l]=c}if(l!==s){0!==l&&(e=e.slice(l)),a=n(a,s,s=l+3*e.length);var u=D().subarray(a+l,a+s);l+=P(e,u).written}return A=l,a}function F(e,t){return J.apply(this,arguments)}function J(){return(J=Object(w.a)(v.a.mark((function e(t,n){var i,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("function"===typeof Response&&t instanceof Response)){e.next=23;break}if("function"!==typeof WebAssembly.instantiateStreaming){e.next=15;break}return e.prev=2,e.next=5,WebAssembly.instantiateStreaming(t,n);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),"application/wasm"==t.headers.get("Content-Type")){e.next=14;break}console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e.t0),e.next=15;break;case 14:throw e.t0;case 15:return e.next=17,t.arrayBuffer();case 17:return i=e.sent,e.next=20,WebAssembly.instantiate(i,n);case 20:return e.abrupt("return",e.sent);case 23:return e.next=25,WebAssembly.instantiate(t,n);case 25:if(!((r=e.sent)instanceof WebAssembly.Instance)){e.next=30;break}return e.abrupt("return",{instance:r,module:t});case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function Y(e){return U.apply(this,arguments)}function U(){return(U=Object(w.a)(v.a.mark((function e(t){var n,r,s,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n={}).wbg={},n.wbg.__wbg_new_59cb74e423758ede=function(){return I(new Error)},n.wbg.__wbg_stack_558ba5917b466edd=function(e,t){var n=W(k(t).stack,i.__wbindgen_malloc,i.__wbindgen_realloc),r=A;C()[e/4+1]=r,C()[e/4+0]=n},n.wbg.__wbg_error_4bb6c2a97407129a=function(e,t){try{console.error(q(e,t))}finally{i.__wbindgen_free(e,t)}},n.wbg.__wbindgen_object_drop_ref=function(e){O(e)},("string"===typeof t||"function"===typeof Request&&t instanceof Request||"function"===typeof URL&&t instanceof URL)&&(t=fetch(t)),e.t0=F,e.next=11,t;case 11:return e.t1=e.sent,e.t2=n,e.next=15,(0,e.t0)(e.t1,e.t2);case 15:return r=e.sent,s=r.instance,a=r.module,i=s.exports,Y.__wbindgen_wasm_module=a,e.abrupt("return",i);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=Y,Z=n(0),H=!1;Q("/make-a-microprocessor/libsnpspice_bg.wasm").then((function(){H=!0,i.init_panic_hook()}));function $(e){var t=window.Sk;if(void 0===t.builtinFiles||void 0===t.builtinFiles.files[e])throw"File not found: '"+e+"'";return t.builtinFiles.files[e]}n(35).addDefineSimpleMode(b.a),b.a.defineSimpleMode("complang",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(?:pfet|nfet|probe|wire|button|signal)\b/,token:"keyword"},{regex:/(?:vdd|gnd)\b/,token:"builtin"},{regex:/[01]+[.][.][.]/i,token:"number"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/`.*`/,token:"units"},{regex:/\/\/.*/,token:"comment"},{regex:/[-+\/*=<>!~]+/,token:"operator"},{regex:/\$[a-zA-Z_][a-zA-Z0-9_']*/,token:"compilevar"},{regex:/[a-zA-Z_][a-zA-Z0-9_']*/,token:"neutral"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}});var G=function(){function e(){Object(h.a)(this,e),this.weights=new Map,this.parents=new Map}return Object(p.a)(e,[{key:"canonicalize",value:function(e){this.weights.has(e)||(this.weights.set(e,1),this.parents.set(e,e));for(var t=[e],n=this.parents.get(e);n!==t[t.length-1];)t.push(n),n=this.parents.get(n);for(var i=0,r=t;i<r.length;i++){var s=r[i];this.parents.set(s,n)}return n}},{key:"union",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(0!==n.length){var r,s=n.map((function(t){return e.canonicalize(t)})),a=0,o=null,l=0,c=Object(d.a)(s);try{for(c.s();!(r=c.n()).done;){var u=r.value,x=this.weights.get(u);a+=x,x>l&&(o=u,l=x)}}catch(f){c.e(f)}finally{c.f()}this.weights.set(o,a);var h,p=Object(d.a)(s);try{for(p.s();!(h=p.n()).done;){var g=h.value;g!==o&&this.parents.set(g,o)}}catch(f){p.e(f)}finally{p.f()}}}}]),e}();function K(e,t,n){var i,r=30*(t.probes.length+1),s=[],a=0,o=Object(d.a)(t.probes);try{for(o.s();!(i=o.n()).done;){var l,c=i.value,u=[],x=[],h=0,p=-1,g=t.netTraces.get(c.net),f=Object(d.a)(g);try{for(f.s();!(l=f.n()).done;){var b=l.value,m=3+h*e.xStep,_=3,v=27;if(0===b||(1===b?_=v=27:2===b?_=v=3:3===b&&(p=m)),0===h?u.push("M ".concat(m," ").concat(v)):u.push("L ".concat(m," ").concat(v)),x.push("L ".concat(m," ").concat(_)),h++,p>=0)break}}catch(j){f.e(j)}finally{f.f()}x.reverse(),x.push("Z"),s.push(Object(Z.jsxs)("g",{transform:"translate(140 ".concat(30*a,")"),children:[Object(Z.jsx)("text",{x:-140,y:20,stroke:"white",fill:"white",children:c.label}),Object(Z.jsx)("path",{d:[].concat(u,x).join(" "),stroke:"white",strokeWidth:e.xStep>=5?3:e.xStep>=4?2:1.5,fill:"rgba(255, 255, 255, 0.3)"}),-1!==p&&Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)("path",{d:"M ".concat(p," 3 L ").concat(p+110," 3 L ").concat(p+110," 27 L ").concat(p," 27 Z"),stroke:"red",strokeWidth:3,fill:"rgba(255, 0, 0, 0.3)"}),Object(Z.jsx)("text",{x:p+55,y:20,textAnchor:"middle",stroke:"red",fill:"red",children:"Shoot through!"})]})]},a)),a++}}catch(j){o.e(j)}finally{o.f()}for(var w=143+e.xStep*n.failureTime,y=[],k=1+e.clockDivider;k<e.simSteps;k+=e.clockDivider*e.tickSpacing)y.push(Object(Z.jsx)("path",{d:"M ".concat(143+e.xStep*k," 0 l 0 ").concat(r-30),stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:2,fill:"transparent"}));return Object(Z.jsxs)("svg",{style:{width:"100%",height:r},children:[s,!n.success&&Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)("path",{d:"M ".concat(w," 0 L ").concat(w," ").concat(r-20),stroke:"red",strokeWidth:2,fill:"transparent"}),Object(Z.jsx)("text",{textAnchor:"middle",x:w,y:r-5,stroke:"red",fill:"red",children:n.miniMessage})]}),y]})}function V(e,t){localStorage.setItem("level-"+e+"-meta",JSON.stringify(t.metadata)),localStorage.setItem("level-"+e+"-saved-code",t.code)}function X(e,t){var n,i=Object(d.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,s=r.net,a=r.netName,o=r.reqs,l=r.failureMessages,c=e.netTraces.get(s);if(void 0===c)return{success:!1,failureTime:0,message:"Signal "+a+" is undefined. Are you calling get_level_outputs?",miniMessage:"Signal "+a+" undefined"};var u,h=Object(d.a)(o);try{for(h.s();!(u=h.n()).done;){var p=Object(x.a)(u.value,2),g=p[0],f=p[1];if(-1!=f&&c[g]!==f){var b={0:"undriven",1:"low",2:"high"},m=b[c[g]],_=b[f],v="".concat(a," is ").concat(m,", but should have been ").concat(_,"."),w="".concat(a," should be ").concat(_);if(void 0!==l){var y=Object(x.a)(l,2);v=y[0],w=y[1]}return{success:!1,failureTime:g,message:v,miniMessage:w}}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){i.e(k)}finally{i.f()}return{success:!0,failureTime:0,message:"All tests passed!",miniMessage:""}}function ee(e,t){var n,i=[],r=Math.round(.8*e),s=Object(d.a)(t);try{for(s.s();!(n=s.n()).done;){var a=n.value;"z"===a?i.push([r,0]):"0"===a?i.push([r,1]):"1"===a?i.push([r,2]):"x"===a&&i.push([r,-1]),r+=e}}catch(o){s.e(o)}finally{s.f()}return i}var te=[{internalName:"fets",name:"FETs",levelDesc:'Welcome to make-a-microprocessor, where you use FETs to solve a series of puzzles.\n\nWrite your "Python" program in the left pane, calling functions to make electrical components. Run your program by hitting ctrl + enter in the code pane.\n\nTo get a list of electrical components and code to construct them click on the "Parts List" button in the top left.\n\nYour goal in this first level is to use two FETs to drive the `not_A` net to be high when `A` is low, and vice versa (an inverter/not gate).',startingCode:'# Your Python code here.\n\n# The nets vdd and gnd are built in, and are always 1 and 0 respectively.\nprobe("Power", vdd)\nprobe("Ground", gnd)\n\nA, = get_level_inputs()\nnot_A, = get_level_outputs()\n\nprobe("A", A)\nprobe("\xacA", not_A)\n\n# Hint:\n# nfet(gate, drain, source)\n# pfet(gate, drain, source)\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_A",pattern:Object(u.a)("01"),repeat:!0}),["_net_A"]},makeOutputNets:function(){return["_net_not_A"]},gradeResults:function(e,t){return X(t,[{net:"_net_not_A",netName:"\xacA",reqs:ee(e.clockDivider,"1010")}])},xStep:5,simSteps:400,clockDivider:10,tickSpacing:1},{internalName:"highz",name:"High-Z Output",levelDesc:"A component's output is said to be high Z (high impedance) when it isn't driven by the component. In this level you must construct a gated inverter that takes a second `output_enable` signal. Your gated inverter must drive the output if and only if `output_enable` is high.\n\nSpecifically, your component's truth table must be:\n\n  A | OE | out\n  -------------\n  0 | 0  |  Z\n  1 | 0  |  Z\n  0 | 1  |  1\n  1 | 1  |  0\n",startingCode:'A, output_enable = get_level_inputs()\nnot_A, = get_level_outputs()\n\nprobe("Output enable", output_enable)\nprobe("A", A)\nprobe("\xacA", not_A)\n\n# Hint: You can create your own signals for testing purposes.\ntest_signal = signal("001z10...")\nprobe("Test signal", test_signal)\n\n# You might also want to check out new_net() and wire_together(net1, net2) in the Parts List.\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_A",pattern:Object(u.a)("z01001010"),repeat:!1},{kind:"signal",net:"_net_output_enable",pattern:Object(u.a)("000011100"),repeat:!1}),["_net_A","_net_output_enable"]},makeOutputNets:function(){return["_net_not_A"]},gradeResults:function(e,t){return X(t,[{net:"_net_not_A",netName:"\xacA",reqs:ee(e.clockDivider,"zzzz101z")}])},xStep:5,simSteps:400,clockDivider:10,tickSpacing:1},{internalName:"logic_gates",name:"Logic Gates",levelDesc:"We will now create logic gates. Implement each of the listed gate functions.\n\nThese definitions will be extremely useful, so you may wish to copy some or all of them to later levels as well.\n\nAll your logic gate implementations must drive their output even if an input is undriven (high Z) so long as the other input(s) are sufficient to determine the output. For example, your AND implementation must drive the output low if one input is low and the other is undriven.\n\nDo not worry if your gate implementations produce garbage outputs for a small amount of time after their inputs switch. This is a normal part of combinational logic, and is known as the propagation delay. Some nomenclature:\n\n  Propagation delay: Max time from an input change to output stabilizing.\n  Contamination delay: Min time from an input change to output change.",startingCode:'\ndef not_gate(x):\n    r = new_net()\n    ...\n    return r\n\ndef nand_gate(x, y):\n    r = new_net()\n    ...\n    return r\n\ndef and_gate(x, y):\n    r = new_net()\n    ...\n    return r\n\ndef or_gate(x, y):\n    r = new_net()\n    ...\n    return r\n\ndef xor_gate(x, y):\n    r = new_net()\n    ...\n    return r\n\ndef mux_gate(select, x, y):\n    r = new_net()\n    ...\n    return r\n\nA, B, C = get_level_inputs()\nnot_out, nand_out, and_out, or_out, xor_out, mux_out = get_level_outputs()\n\nprobe("A", A)\nprobe("B", B)\nprobe("C", C)\nprobe("\xacA", not_out)\nprobe("\xac(A \u2227 B)", nand_out)\nprobe("A \u2227 B", and_out)\nprobe("A \u2228 B", or_out)\nprobe("A \u2295 B", xor_out)\nprobe("mux(C, A, B)", mux_out)\n\nwire_together(not_gate(A), not_out)\nwire_together(nand_gate(A, B), nand_out)\nwire_together(and_gate(A, B), and_out)\nwire_together(or_gate(A, B), or_out)\nwire_together(xor_gate(A, B), xor_out)\nwire_together(mux_gate(C, A, B), mux_out)\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_A",pattern:Object(u.a)("01010101zz01z"),repeat:!1},{kind:"signal",net:"_net_B",pattern:Object(u.a)("0011001101zzz"),repeat:!1},{kind:"signal",net:"_net_C",pattern:Object(u.a)("000011110000z"),repeat:!1}),["_net_A","_net_B","_net_C"]},makeOutputNets:function(){return["_net_not_out","_net_nand_out","_net_and_out","_net_or_out","_net_xor_out","_net_mux_out"]},gradeResults:function(e,t){return X(t,[{net:"_net_not_out",netName:"\xacA",reqs:ee(e.clockDivider,"10101010zz10z")},{net:"_net_nand_out",netName:"\xac(A \u2227 B)",reqs:ee(e.clockDivider,"111011101z1zz")},{net:"_net_and_out",netName:"A \u2227 B",reqs:ee(e.clockDivider,"000100010z0zz")},{net:"_net_or_out",netName:"A \u2228 B",reqs:ee(e.clockDivider,"01110111z1z1z")},{net:"_net_xor_out",netName:"A \u2295 B",reqs:ee(e.clockDivider,"01100110zzzzz")},{net:"_net_mux_out",netName:"mux(C, A, B)",reqs:ee(e.clockDivider,"01010011zz01z")}])},xStep:4,simSteps:400,clockDivider:10,tickSpacing:1},{internalName:"adder",name:"Adder",levelDesc:"Your goal is to implement a 3-bit + 3-bit to 3-bit two's complement adder (throwing away the carry bit). The numbers are all little-endian, and thus the first bit in a list is the lowest order.",startingCode:'\ndef adder(a: "List[Net]", b: "List[Net]") -> "List[Net]":\n    assert len(a) == len(b)\n    result = [new_net() for _ in range(len(a))]\n    # Inputs are little endian: a[0] is the lowest order bit.\n    ...\n    return result\n\nA_nets, B_nets = get_level_inputs()\noutput_nets = get_level_outputs()\n\nfor i, n in enumerate(A_nets):\n    probe("A[%i]" % i, n)\nfor i, n in enumerate(B_nets):\n    probe("B[%i]" % i, n)\nfor i, n in enumerate(output_nets):\n    probe("(A + B)[%i]" % i, n)\n\n# Use our adder function, then wire it up to the outputs.\nresult = adder(A_nets, B_nets)\nfor n1, n2 in zip(output_nets, result):\n    wire_together(n1, n2)\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_A0",pattern:Object(u.a)("000111111111z"),repeat:!1},{kind:"signal",net:"_net_A1",pattern:Object(u.a)("000000000111z"),repeat:!1},{kind:"signal",net:"_net_A2",pattern:Object(u.a)("000000000000z"),repeat:!1},{kind:"signal",net:"_net_B0",pattern:Object(u.a)("000000111111z"),repeat:!1},{kind:"signal",net:"_net_B1",pattern:Object(u.a)("000000000000z"),repeat:!1},{kind:"signal",net:"_net_B2",pattern:Object(u.a)("000000000111z"),repeat:!1}),[["_net_A0","_net_A1","_net_A2"],["_net_B0","_net_B1","_net_B2"]]},makeOutputNets:function(){return["_net_sum0","_net_sum1","_net_sum2"]},gradeResults:function(e,t){return X(t,[{net:"_net_sum0",netName:"(A + B)[0]",reqs:ee(e.clockDivider,"xx0xx1xx0xx0")},{net:"_net_sum1",netName:"(A + B)[1]",reqs:ee(e.clockDivider,"xx0xx0xx1xx0")},{net:"_net_sum2",netName:"(A + B)[2]",reqs:ee(e.clockDivider,"xx0xx0xx0xx0")}])},xStep:3,simSteps:400,clockDivider:10,tickSpacing:1},{internalName:"flipflops",name:"Flip-Flops",levelDesc:"Your goal is to implement three components that each store one bit of data:\n\nSet-reset latch (SR latch):\nThe SR latch has two inputs: set and reset, and two outputs: Q and \xacQ. When set is high and reset low, Q immediately goes high and \xacQ low. When reset is high and set is low, Q immediately goes low and \xacQ high. When both set and reset are both low the output state holds the last value.\n\nD flip-flop based register:\nThe register has two inputs, D and clk, and two outputs, Q and \xacQ. The register stores a single bit, which it outputs to Q and \xacQ at all times. The behavior is that on the rising edge of the clk signal the register samples D, and sets the bit of state equal to it.\n\n(Hint: You can use two SR latches to make this register.)\n\nDon't fret if your register can give the wrong output (or even enter funny states where the output oscillates) if the D signal changes too close to the rising clock edge. Your register will have a characteristic setup time and hold time:\n\n  Setup time: Min time that D must have its target value *before* the rising clock edge to avoid malfunction.\n  Hold time: Min time that D must hold its target value *after* the rising clock edge to avoid malfunction.\n",startingCode:'\ndef sr_latch(s, r):\n    q, not_q = new_net(), new_net()\n    ...\n    return q, not_q\n\ndef register(d, clk):\n    q, not_q = new_net(), new_net()\n    ...\n    return q, not_q\n\nset, reset, d, clk = get_level_inputs()\nq, not_q, register_out = get_level_outputs()\n\nfor a, b in zip(sr_latch(set, reset), (q, not_q)):\n    wire_together(a, b)\n\nwire_together(register(d, clk)[0], register_out)\n\nprobe("SR latch\'s set", set)\nprobe("SR latch\'s reset", reset)\nprobe("SR latch\'s Q", q)\nprobe("SR latch\'s \xacQ", not_q)\n\nprobe("Register\'s D", d)\nprobe("Register\'s clk", clk)\nprobe("Register\'s output", register_out)\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_set",pattern:Object(u.a)("010000000100000"),repeat:!1},{kind:"signal",net:"_net_reset",pattern:Object(u.a)("000001000000010"),repeat:!1},{kind:"signal",net:"_net_d",pattern:Object(u.a)("0000011000000110"),repeat:!1},{kind:"signal",net:"_net_clk",pattern:Object(u.a)("00110011001100110"),repeat:!1}),["_net_set","_net_reset","_net_d","_net_clk"]},makeOutputNets:function(){return["_net_q","_net_not_q","_net_register_out"]},gradeResults:function(e,t){return X(t,[{net:"_net_q",netName:"SR latch's Q",reqs:ee(e.clockDivider,"xx111x000x111x000")},{net:"_net_not_q",netName:"SR latch's \xacQ",reqs:ee(e.clockDivider,"xx000x111x000x111")},{net:"_net_register_out",netName:"Register's output",reqs:ee(e.clockDivider,"xxx000x111x000x11")}])},xStep:3,simSteps:400,clockDivider:10,tickSpacing:1},{internalName:"state_machine",name:"State Machines",levelDesc:'This level is much harder than all previous. Your goal will be to implement a circuit that takes in decimal digits one at a time over a serial bus, and outputs if the number is a multiple of seven. On each rising clock edge you must read the `reset` and `data_in` lines, and update your state and the output line. You will receive decimal digits as sets of four bits, encoded in big-endian, transmitted over four consecutive clock cycles.\n\nLet us use strings to represent possible inputs over the serial bus to your circuit. We will denote a cycle in which `reset` is high by "R", and otherwise denote the value of `data_in` by either "0", or "1". Therefore, "R0000" will denote the input in which the clock has five rising edges, the first where `reset` is high (and therefore `data_in`\'s value doesn\'t matter), and the remaining where `reset` is low and `data_in` is low.\n\nThis input of "R0000" would correspond to feeding in just the single decimal digit 0 to our circuit. After receiving this input the output `div7` must be high. Likewise, the input of "R00010111" would correspond to feeding in the decimal digits 1, then 7, representing the number 17. This is not a multiple of seven, so `div7` would be required to be low after this input.\n\nAs another example, if fed "R0001R0111" your circuit must set `div7` low after the first digit is ingested, but then must set `div7` high at the very end, because the second reset throws away the first 1 digit. Therefore, the number being processed at the very end is just 7, not 17.\n\nYour circuit must work for arbitrarily large numbers. You will only be graded on your output after each complete digit is fed in, and you won\'t be graded on your output before any digits are fed in or before the first reset. Nor will you be graded on inputs like "R1010" that use invalid digits.\n\nThe test cases being fed in are:\n0 (yes)\n1 (no)\n7 (yes)\n14 (no (after just the first digit has been fed in), then yes)\n17 (no, then no)\n791 (yes, then no, then yes)\n',startingCode:'\nclk, reset, data_in = get_level_inputs()\ndiv7, = get_level_outputs()\n\nprobe("Clock", clk)\nprobe("Reset", reset)\nprobe("Data in", data_in)\nprobe("Divisible by 7?", div7)\n',makeInputNets:function(e){return e.push({kind:"signal",net:"_net_clk",pattern:Object(u.a)("01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101z"),repeat:!1},{kind:"signal",net:"_net_reset",pattern:Object(u.a)("11000000001100000000110000000011000000000000000011000000000000000011000000000000000000000000z"),repeat:!1},{kind:"signal",net:"_net_data_in",pattern:Object(u.a)("zz00000000zz00000011zz00111111zz0000001100110000zz0000001100111111zz001111111100001100000011z"),repeat:!1}),["_net_clk","_net_reset","_net_data_in"]},makeOutputNets:function(){return["_net_div7"]},gradeResults:function(e,t){return X(t,[{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxx1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 0, which is divisible by seven","0 is divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxx0xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 1, which is not divisible by seven","1 is not divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 7, which is divisible by seven","7 is divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 1 (just the first digit of 14), which is not divisible by seven","1 is not divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 14, which is divisible by seven","14 is divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 1 (just the first digit of 17), which is not divisible by seven","1 is not divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0xxxxxxxxxxxxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 17, which is not divisible by seven","17 is not divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx1xxxxxxxxxxxxxxxx"),failureMessages:["The input being tested at this point is 7 (just the first digit of 791), which is divisible by seven","7 is divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0xxxxxxxx"),failureMessages:["The input being tested at this point is 79 (just the first two digits of 791), which is not divisible by seven","79 is not divisible"]},{net:"_net_div7",netName:"Divisible by 7?",reqs:ee(e.clockDivider,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx1"),failureMessages:["The input being tested at this point is 791, which is divisible by seven","791 is divisible"]}])},xStep:.06,simSteps:15e3,clockDivider:150,tickSpacing:2},{internalName:"sram",name:"SRAM",levelDesc:"This level isn't complete yet. Come back later.",startingCode:"# Your code here.\n",makeInputNets:function(){return["_net_A","_net_output_enable"]},makeOutputNets:function(){return["_net_notA"]},gradeResults:function(e){return{success:!1,failureTime:3,message:"bad",miniMessage:"?"}},xStep:.06,simSteps:15e3,clockDivider:150,tickSpacing:2},{internalName:"microprocessor",name:"Microprocessor",levelDesc:"This is the first level.\nTo open up the documentation press ",startingCode:"# Your code here.\n",makeInputNets:function(){return["_net_A","_net_output_enable"]},makeOutputNets:function(){return["_net_notA"]},gradeResults:function(e){return{success:!1,failureTime:3,message:"bad",miniMessage:"?"}},xStep:1,simSteps:400,clockDivider:10,tickSpacing:1}],ne=function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(e){var i;return Object(h.a)(this,n),(i=t.call(this,e)).state={code:e.startingCode},i}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return Object(Z.jsxs)("div",{children:[Object(Z.jsx)(g.Controlled,{value:this.state.code,options:{mode:"python",theme:"material",lineNumbers:!0,indentUnit:4,lineWrapping:!0,extraKeys:this.props.extraKeysMaker(this)},onBeforeChange:function(t,n,i){e.setState({code:i})}}),this.props.getSavedCode()!==this.state.code&&Object(Z.jsx)("div",{style:{position:"absolute",right:20,bottom:20,userSelect:"none",pointerEvents:"none",zIndex:5,color:"red",opacity:.5},children:"\u2b24 Unsaved (ctrl + s to save)"})]})}}]),n}(s.a.PureComponent),ie=function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(e){var i;Object(h.a)(this,n),(i=t.call(this,e)).levelStates=void 0,i.textEditorRef=s.a.createRef(),i.onCompile=function(e){var t=window.Sk;t.pre="output";var n=[],r=[],s=0;function a(){return(++s).toString()}t.builtins.vdd=t.ffi.remapToPy("vdd"),t.builtins.gnd=t.ffi.remapToPy("gnd"),t.builtins.new_net=function(e){return t.ffi.remapToJs(e)+a()},t.builtins.new_net.co_varnames=["name"],t.builtins.new_net.$defaults=["net"],t.builtins.new_net.co_numargs=1,t.builtins.nfet=function(e,n,i){if(void 0===e||void 0===n)throw"nfet must be called like nfet(gate, drain, source) or like nfet(gate, drain) with source implicitly being gnd";if(e=t.ffi.remapToJs(e),n=t.ffi.remapToJs(n),void 0===(i=t.ffi.remapToJs(i))&&(i="gnd"),"string"!==typeof e)throw"nfet(gate, drain, source) gate argument must be net";if("string"!==typeof n)throw"nfet(gate, drain, source) drain argument must be net";if("string"!==typeof i)throw"nfet(gate, drain, source) source argument must be net";r.push({kind:"fet",isPfet:!1,gate:e,drain:n,source:i})},t.builtins.nfet.co_varnames=["gate","drain","source"],t.builtins.nfet.$defaults=[void 0,void 0,void 0],t.builtins.nfet.co_numargs=3,t.builtins.pfet=function(e,n,i){if(void 0===e||void 0===n)throw"pfet must be called like pfet(gate, drain, source) or like pfet(gate, drain) with source implicitly being vdd";if(e=t.ffi.remapToJs(e),n=t.ffi.remapToJs(n),void 0===(i=t.ffi.remapToJs(i))&&(i="vdd"),"string"!==typeof e)throw"pfet(gate, drain, source) gate argument must be net";if("string"!==typeof n)throw"pfet(gate, drain, source) drain argument must be net";if("string"!==typeof i)throw"pfet(gate, drain, source) source argument must be net";r.push({kind:"fet",isPfet:!0,gate:e,drain:n,source:i})},t.builtins.pfet.co_varnames=["gate","drain","source"],t.builtins.pfet.$defaults=[void 0,void 0,void 0],t.builtins.pfet.co_numargs=3,t.builtins.probe=function(e,n){if(e=t.ffi.remapToJs(e),n=t.ffi.remapToJs(n),"string"!==typeof e)throw"probe(label, net) label argument must be string";if("string"!==typeof n)throw"probe(label, net) net argument must be string";r.push({kind:"probe",label:e,net:n})},t.builtins.probe.co_varnames=["label","net"],t.builtins.probe.co_numargs=2,t.builtins.pull_down_resistor=function(e){if("string"!==typeof(e=t.ffi.remapToJs(e)))throw"pull_down_resistor(net) net argument must be string";r.push({kind:"pull_resistor",direction:"down",net:e})},t.builtins.pull_down_resistor.co_varnames=["net"],t.builtins.pull_down_resistor.co_numargs=1,t.builtins.pull_up_resistor=function(e){if("string"!==typeof(e=t.ffi.remapToJs(e)))throw"pull_up_resistor(net) net argument must be string";r.push({kind:"pull_resistor",direction:"up",net:e})},t.builtins.pull_up_resistor.co_varnames=["net"],t.builtins.pull_up_resistor.co_numargs=1,t.builtins.wire_together=function(e,n){if(e=t.ffi.remapToJs(e),n=t.ffi.remapToJs(n),"string"!==typeof e)throw"wire_together(net1, net2) net1 argument must be string";if("string"!==typeof n)throw"wire_together(net1, net2) net2 argument must be string";r.push({kind:"wire",nets:[e,n]})},t.builtins.wire_together.co_varnames=["net1","net2"],t.builtins.wire_together.co_numargs=2,t.builtins.signal=function(e,n){var i=t.ffi.remapToJs(n)+a();if(void 0===e)throw'signal must take pattern, like: signal("01...")';var s=(e=t.ffi.remapToJs(e).toLowerCase()).endsWith("...");s&&(e=e.slice(0,-3));var o,l=Object(d.a)(e);try{for(l.s();!(o=l.n()).done;){var c=o.value;if("0"!==c&&"1"!==c&&"z"!==c)throw"The pattern must be made of 0s, 1s and zs, and may optionally end with ... to indicate that the pattern should repeat."}}catch(u){l.e(u)}finally{l.f()}return r.push({kind:"signal",net:i,pattern:e,repeat:s}),t.ffi.remapToPy(i)},t.builtins.signal.co_varnames=["desc","name"],t.builtins.signal.$defaults=[void 0,"signal"],t.builtins.signal.co_numargs=2,t.builtins.make_sram=function(e,n,i,s,a){if(e=t.ffi.remapToJs(e),n=t.ffi.remapToJs(n),i=t.ffi.remapToJs(i),s=t.ffi.remapToJs(s),a=t.ffi.remapToJs(a),[e,n,i,s].includes(void 0))throw"too few arguments to: make_sram(address_nets: List[Net], bus_in_nets: List[Net], bus_out_nets: List[Net], write_enable_net: Net, contents: List[int] = [])";if(n.length!==i.length)throw"make_sram must take the same number of bus_in_nets and bus_out_nets \u2014 both are the word size of the memory";r.push({kind:"sram",contents:new Uint32Array(a),address_nets:e,bus_in_nets:n,bus_out_nets:i,write_enable_net:s})},t.builtins.make_sram.co_varnames=["address_nets","bus_in_nets","bus_out_nets","write_enable_net","contents"],t.builtins.make_sram.$defaults=[void 0,void 0,void 0,void 0,[]],t.builtins.make_sram.co_numargs=5,t.builtins.get_level_inputs=function(){var e=i.state.currentLevel.makeInputNets(r);return t.ffi.remapToPy(e)},t.builtins.get_level_inputs.co_varnames=[],t.builtins.get_level_inputs.co_numargs=0,t.builtins.get_level_outputs=function(){var e=i.state.currentLevel.makeOutputNets(r);return r.push({kind:"trace",nets:e}),t.ffi.remapToPy(e)},t.builtins.get_level_outputs.co_varnames=[],t.builtins.get_level_outputs.co_numargs=0,t.configure({output:function(e){n.push(e.toString())},read:$}),t.misceval.asyncToPromise((function(){return t.importMainWithBody("<stdin>",!1,e,!0)})).then((function(e){var t=n.join("");t&&!t.endsWith("\n")&&(t+="\n"),i.setState({terminalOutput:t,paneColor:"#222"}),i.simulate(r)}),(function(e){i.setState({terminalOutput:n.join("")+"\n"+e.toString(),simOutput:"",paneColor:"#433"})}))},i.getIsUnsaved=function(){return i.getCode()!==i.getSavedCode()},i.getSavedCode=function(){return i.levelStates.get(i.state.currentLevel.internalName).code},i.levelStates=new Map,i.loadLevelStatesFromLocalStorage(),i.state={page:"level-select",currentLevel:null,terminalOutput:"",simOutput:"",simResults:null,grading:null,paneColor:"#222",docsOpen:!1,cheatMode:!1},window.onpopstate=function(e){i.navigateBack()};var r=0,a="unlock";return document.addEventListener("keydown",(function(e){e.key===a[r]?++r>=a.length&&i.setState({cheatMode:!0}):r=0})),i}return Object(p.a)(n,[{key:"loadLevelStatesFromLocalStorage",value:function(){this.levelStates=new Map;var e,t=Object(d.a)(te);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=JSON.parse(localStorage.getItem("level-"+n.internalName+"-meta")||'{"savedVersion": 1, "everBeaten": false, "everOpened": false}'),r=localStorage.getItem("level-"+n.internalName+"-saved-code")||n.startingCode;this.levelStates.set(n.internalName,{metadata:i,code:r})}}catch(s){t.e(s)}finally{t.f()}}},{key:"reportError",value:function(e,t){var n=this.getCode().split("\n")[e-1];this.setState({terminalOutput:"  ".concat(n,"\n\nError on line ").concat(e,": ").concat(t)})}},{key:"simulate",value:function(e){var t=performance.now();e=[].concat(Object(u.a)(e),[{kind:"signal",net:"vdd",pattern:["1"],repeat:!1},{kind:"signal",net:"gnd",pattern:["0"],repeat:!1}]);var n,r=new Set(["vdd","gnd"]),s=new Set,a=[],o=new G,l=Object(d.a)(e);try{for(l.s();!(n=l.n()).done;){var c=n.value;switch(c.kind){case"fet":for(var x=0,h=[c.gate,c.drain,c.source];x<h.length;x++){var p=h[x];r.add(p)}break;case"wire":var g,f=Object(d.a)(c.nets);try{for(f.s();!(g=f.n()).done;){var b=g.value;r.add(b)}}catch(ee){f.e(ee)}finally{f.f()}o.union.apply(o,Object(u.a)(c.nets));break;case"probe":a.push(c),r.add(c.net),s.add(c.net);break;case"trace":var m,_=Object(d.a)(c.nets);try{for(_.s();!(m=_.n()).done;){var v=m.value;s.add(v)}}catch(ee){_.e(ee)}finally{_.f()}break;case"pull_resistor":case"button":case"signal":r.add(c.net)}}}catch(ee){l.e(ee)}finally{l.f()}if(H){var w,y=[],k=new Map,j=Object(d.a)(r);try{for(j.s();!(w=j.n()).done;){var O=w.value,S=o.canonicalize(O);k.has(S)||k.set(S,k.size),k.set(O,k.get(S))}}catch(ee){j.e(ee)}finally{j.f()}var z,A=Object(d.a)(e);try{for(A.s();!(z=A.n()).done;){var T=z.value;switch(T.kind){case"fet":y.push(1,+T.isPfet,k.get(T.gate),k.get(T.drain),k.get(T.source));break;case"signal":y.push.apply(y,[2,k.get(T.net),+T.repeat,T.pattern.length].concat(Object(u.a)(Object(u.a)(T.pattern).map((function(e){return{0:0,1:1,z:2}[e]})))));break;case"pull_resistor":y.push(3,{up:0,down:1}[T.direction],k.get(T.net));break;case"sram":y.push.apply(y,[4,T.address_nets.length,T.bus_in_nets.length,k.get(T.write_enable_net),T.contents.length].concat(Object(u.a)(T.contents),Object(u.a)(T.address_nets.map((function(e){return k.get(e)}))),Object(u.a)(T.bus_in_nets.map((function(e){return k.get(e)}))),Object(u.a)(T.bus_out_nets.map((function(e){return k.get(e)})))));break;default:continue}y.push(123456789)}}catch(ee){A.e(ee)}finally{A.f()}for(var N=M(new Uint32Array(y),new Uint32Array(Array.from(s).map((function(e){return k.get(e)}))),k.size,this.state.currentLevel.simSteps,this.state.currentLevel.clockDivider),C=B(),L=[],D=0;D<C.length;D+=2){var R=C[D],q=C[D+1],I=N.slice(R,R+q);L.push(I)}var E,P=i.get_first_shoot_through(),W=-1!==P,F=new Map,J=0,Y=Object(d.a)(s);try{for(Y.s();!(E=Y.n()).done;){var U=E.value;F.set(U,L[J++])}}catch(ee){Y.e(ee)}finally{Y.f()}var Q=performance.now()-t,Z="------- Simulation completed in: ".concat(Math.round(Q),"ms (Components: ").concat(e.length-2," Nets: ").concat(r.size,")"),$={components:e.length,nets:Object(u.a)(r),netTraces:F,probes:a,shootThroughOccurred:W,earliestShootThrough:P},K=W?{success:!1,failureTime:P,message:"Shoot through (shorting vdd to gnd) is never allowed.",miniMessage:"Shoot through occurs here"}:this.state.currentLevel.gradeResults(this.state.currentLevel,$);if(K.success){var X=this.levelStates.get(this.state.currentLevel.internalName);X.metadata.everBeaten=!0,V(this.state.currentLevel.internalName,X),this.setState({paneColor:"#343"})}else Z+="\n\nLEVEL FAILED: "+K.message;this.setState({simOutput:Z,simResults:$,grading:K})}else this.setState({simOutput:"Wasm component not initialized."})}},{key:"switchToLevel",value:function(e){this.setState({page:"level",currentLevel:e,terminalOutput:"",simOutput:"(Hit ctrl + enter in the code window to rerun.)",simResults:null,grading:null,paneColor:"#222"});var t=this.levelStates.get(e.internalName);t.metadata.everOpened=!0,V(e.internalName,t),window.history.pushState({page:"level",currentLevel:e.internalName},"Make a Microprocessor")}},{key:"navigateBack",value:function(){this.getIsUnsaved()&&!window.confirm("Exit level without saving work? (Just hit ctrl+s in the code editor.)")||this.setState({page:"level-select"})}},{key:"setCode",value:function(e){null!==this.textEditorRef.current&&this.textEditorRef.current.setState({code:e})}},{key:"getCode",value:function(){return null!==this.textEditorRef.current?this.textEditorRef.current.state.code:'raise Exception("Internal bug: textEditorRef is null")'}},{key:"render",value:function(){var e=this;if("level-select"===this.state.page){var t=!1;return Object(Z.jsxs)("div",{style:{width:"100%",height:"100vh",color:"white",fontFamily:"monospace",display:"flex",justifyContent:"center",textAlign:"center",fontSize:"150%"},children:[Object(Z.jsxs)("div",{style:{marginTop:30},children:[Object(Z.jsx)("span",{style:{fontSize:"200%"},children:"Make a Microprocessor"}),Object(Z.jsx)("br",{}),Object(Z.jsx)("br",{}),"Select a level:",Object(Z.jsx)("br",{}),Object(Z.jsx)("div",{style:{display:"inline-block"},children:Object(Z.jsx)("div",{style:{display:"flex",flexDirection:"column",marginTop:20},children:te.map((function(n,i){var r=e.levelStates.get(n.internalName),s=Object(Z.jsxs)("div",{style:{fontSize:"120%",margin:5,padding:10,width:300,position:"relative"},className:t?"lockedButton":"hoverButton",onClick:t?function(){return null}:function(){return e.switchToLevel(n)},children:[t?"???":n.name,!t&&!r.metadata.everOpened&&Object(Z.jsx)("div",{style:{position:"absolute",fontSize:"80%",color:"red",left:"92%",top:"0%",transform:"rotate(30deg)"},children:"New!"}),r.metadata.everBeaten&&Object(Z.jsx)("div",{style:{position:"absolute",fontSize:"300%",color:"green",left:"100%",top:"50%",transform:"translate(-50%, -50%)"},children:"\u2713"})]},i);return r.metadata.everBeaten||e.state.cheatMode||(t=!0),s}))})})]}),Object(Z.jsx)("div",{style:{position:"absolute",left:10,bottom:10},children:"By Peter Schmidt-Nielsen (v0.3c)"}),Object(Z.jsx)("div",{style:{position:"absolute",right:10,bottom:10,padding:10},className:"hoverButton",onClick:function(){window.confirm("Are you sure you want to completely reset the game state, including throwing away all of your code?")&&(localStorage.clear(),e.loadLevelStatesFromLocalStorage(),e.forceUpdate())},children:"Reset Entire Game State"})]})}var n=parseInt(localStorage.getItem("split1")||"500");parseInt(localStorage.getItem("split2")||"400");return Object(Z.jsxs)("div",{style:{display:"flex"},children:[Object(Z.jsxs)(m.a,{split:"vertical",minSize:300,defaultSize:n,onChange:function(e){return localStorage.setItem("split1",e.toString())},resizerStyle:{background:"black",width:"3px",minWidth:"3px",cursor:"col-resize",height:"100%",zIndex:20},children:[Object(Z.jsxs)("div",{style:{position:"relative"},children:[Object(Z.jsxs)("div",{style:{display:"flex",alignItems:"center",background:"#444",borderBottom:"2px solid #222",height:60},children:[Object(Z.jsx)("div",{style:{bottom:10,right:70},className:"mainButton",onClick:function(){return e.navigateBack()},children:"\u276e"}),Object(Z.jsx)("div",{style:{bottom:10,right:10},className:"mainButton",onClick:function(){return e.setState({docsOpen:!e.state.docsOpen})},children:"Parts List"}),Object(Z.jsx)("div",{style:{bottom:10,right:10},className:"mainButton",onClick:function(){window.confirm("Throw away your code and reset to the level's starting code?")&&e.setCode(e.state.currentLevel.startingCode)},children:"Reset code"})]}),Object(Z.jsx)(ne,{ref:this.textEditorRef,startingCode:this.levelStates.get(this.state.currentLevel.internalName).code,getSavedCode:this.getSavedCode,extraKeysMaker:function(t){return{"Ctrl-Enter":function(n){e.onCompile(t.state.code)},"Ctrl-S":function(n){var i=e.levelStates.get(e.state.currentLevel.internalName);i.code=t.state.code,V(e.state.currentLevel.internalName,i),e.forceUpdate()}}}})]}),Object(Z.jsx)("div",{children:Object(Z.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(Z.jsx)("div",{style:{width:"100%",height:"60vh",backgroundColor:"#333",color:"white",fontFamily:"monospace",overflow:"scroll"},children:Object(Z.jsx)("div",{style:{margin:10},children:null!==this.state.simResults&&K(this.state.currentLevel,this.state.simResults,this.state.grading)})}),Object(Z.jsxs)("div",{style:{backgroundColor:this.state.paneColor,color:"white",fontFamily:"monospace",width:"100%",height:"40vh",display:"flex"},children:[Object(Z.jsxs)("div",{style:{padding:10,width:500,backgroundColor:"#222",overflowY:"scroll"},children:[Object(Z.jsx)("b",{children:this.state.currentLevel.name}),Object(Z.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:this.state.currentLevel.levelDesc})]}),Object(Z.jsx)("div",{style:{width:2,backgroundColor:"#555"}}),Object(Z.jsxs)("div",{style:{margin:10,whiteSpace:"pre-wrap",color:"white",overflow:"scroll",width:"100%"},children:[this.state.terminalOutput&&Object(Z.jsxs)(Z.Fragment,{children:["Python output:",Object(Z.jsx)("br",{}),Object(Z.jsx)("span",{style:{color:"lightblue"},children:this.state.terminalOutput}),Object(Z.jsx)("br",{}),Object(Z.jsx)("br",{})]}),this.state.simOutput]})]})]})})]}),"#343"===this.state.paneColor&&Object(Z.jsx)("div",{style:{position:"absolute",right:30,bottom:30,padding:20,fontSize:"400%",boxShadow:"0px 0px 50px green"},className:"hoverButton",onClick:function(){e.navigateBack()},children:"You win!"}),Object(Z.jsxs)("div",{style:{position:"absolute",width:800,height:"100%",boxSizing:"border-box",boxShadow:"0px 0px 10px black",right:this.state.docsOpen?810:0,zIndex:100,backgroundColor:"#aaa",transition:"0.2s right",padding:10,transform:"translate(810px, 0px)",overflowY:"scroll"},children:[Object(Z.jsx)("div",{style:{position:"sticky",top:0},children:Object(Z.jsx)("div",{style:{position:"absolute",top:5,right:5,fontSize:"120%",padding:4},className:"hoverButton",onClick:function(){return e.setState({docsOpen:!1})},children:"\u2715"})}),Object(Z.jsx)("span",{style:{fontSize:"150%",fontWeight:"bold"},children:"Parts list"}),Object(Z.jsxs)("div",{style:{marginTop:10},children:['The code area is "Python". Hit ctrl + enter in the code area to rerun it, and hit ctrl + s to save your code. I provide functions that construct circuit components as a side effect. The four functions you need to use to assemble your circuit are:',Object(Z.jsxs)("div",{style:{marginLeft:20,marginBottom:20},children:[Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"nfet(gate: Net, drain: Net, source: Optional[Net])"}),Object(Z.jsxs)("div",{style:{marginLeft:20},children:["Constructs an n-channel FET in the circuit. The behavior is:",Object(Z.jsx)("pre",{style:{marginLeft:20},children:"if gate is high and source is low:\n    drive drain low"}),"If the source argument is omitted it defaults to ",Object(Z.jsx)("code",{children:"gnd"})," (always low). Examples:",Object(Z.jsx)("pre",{style:{marginLeft:20},children:"# Pulls `output` down whenever `gate` is high.\nnfet(gate, output, gnd)\n\n# This is equivalent to the above, as gnd is implicit.\nnfet(gate, output)\n\n# Here two nfets are wired in series. Thus, `output` is\n# pulled down when both `gate1` and `gate2` are high.\nintermediate = new_net()\nnfet(gate1, intermediate)\nnfet(gate2, output, intermediate)"}),"There is no modeled body diode, so the FET simply does nothing (doesn't conduct) if source is high and drain is low (pass transistor logic is not allowed). Additionally, no gate capacitance is modeled \u2014 all nets that aren't driven return to a floating state which doesn't switch FETs on."]}),Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"pfet(gate: Net, drain: Net, source: Optional[Net])"}),Object(Z.jsxs)("div",{style:{marginLeft:20},children:["Constructs a p-channel FET in the circuit. The behavior is:",Object(Z.jsx)("pre",{style:{marginLeft:20},children:"if gate is low and source is high:\n    drive drain high"}),"If the source argument is omitted it defaults to ",Object(Z.jsx)("code",{children:"vdd"})," (always high). Again, there is no modeled body diode or gate capacitance."]}),Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"new_net() -> Net"}),Object(Z.jsx)("div",{style:{marginLeft:20},children:"Creates a new unique net (electrical node in your circuit), and returns it."}),Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"wire_together(net1: Net, net2: Net)"}),Object(Z.jsx)("div",{style:{marginLeft:20},children:"Connect two nets together so that they are electrically equivalent."})]}),"I provide two additional functions for debugging and testing purposes:",Object(Z.jsxs)("div",{style:{marginLeft:20,marginBottom:20},children:[Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"probe(label: str, net: Net)"}),Object(Z.jsx)("div",{style:{marginLeft:20},children:"Causes a net's voltage to be plotted in the simulation results pane (top right)."}),Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"signal(pattern: str) -> Net"}),Object(Z.jsxs)("div",{style:{marginLeft:20},children:["Constructs a signal generator component, and returns the generator's output net. The pattern string must be made of 0s, 1s, and zs, and may optionally end with ... to indicate that the pattern should repeat. The value z indicates that the signal generator shouldn't drive the output (high Z). Examples:",Object(Z.jsx)("pre",{style:{marginLeft:20},children:"# Creates a clock signal that toggles every time step.\nclock = signal('01...')\n\n# The signal waits three time steps, then drives high,\n# then stops driving forever.\noutput = signal('zzz1z')"})]})]}),"In the last two levels we will also use the SRAM component:",Object(Z.jsxs)("div",{style:{marginLeft:20,marginBottom:20},children:[Object(Z.jsx)("pre",{style:{fontWeight:"bold",fontSize:"120%"},children:"make_sram(\n  # Input nets that are the bits of the address. (Length sets the address size.)\n  address_nets: List[Net],\n\n  # Input nets to give the value when writing. (Length sets the word size.)\n  bus_in_nets: List[Net],\n\n  # Output nets driven by the SRAM when reading. (Must be same length as bus_in_nets.)\n  bus_out_nets: List[Net],\n\n  # Drive write_enable_net low to read, drive high to write.\n  write_enable_net: Net,\n\n  # An optional list of initial values for the SRAM.\n  # (Length may be at most 2**len(address_nets), remaining words are uninitialized.)\n  contents: List[int] = [],\n)"}),Object(Z.jsxs)("div",{style:{marginLeft:20},children:["Constructs a read-write word-addressed SRAM, optionally initialized with some chosen data. Drive the ",Object(Z.jsx)("code",{children:"address_nets"})," to select a word in the memory. If ",Object(Z.jsx)("code",{children:"write_enable_net"})," is low then the selected memory word is read, and the ",Object(Z.jsx)("code",{children:"bus_out_nets"})," are driven with its value. If ",Object(Z.jsx)("code",{children:"write_enable_net"})," is high then the selected memory word is updated to be equal to the value on ",Object(Z.jsx)("code",{children:"bus_in_nets"}),", and the ",Object(Z.jsx)("code",{children:"bus_out_nets"})," are high-Z. The ",Object(Z.jsx)("code",{children:"bus_in_nets"})," are always high-Z. There are no setup or hold times (the SRAM is modeled as nearly instant), and the propagation and contamination delays are also nearly instant. Example:",Object(Z.jsx)("pre",{style:{marginLeft:20},children:"address_nets = [new_net() for _ in range(12)]\nbus_in_nets  = [new_net() for _ in range(4)]\nbus_out_nets = [new_net() for _ in range(4)]\nwrite_enable_net = new_net()\n\n# Constructs an SRAM that can address 2**12 distinct 4-bit words.\nmake_sram(\n    address_nets,\n    bus_in_nets,\n    bus_out_nets,\n    write_enable_net,\n    # Initialize all 2**12 of the words to be 1010.\n    # This initializer argument is optional.\n    [0b1010 for _ in range(2**12)],\n)"}),"If you do not use the optional contents intializer then the endianness of the address and bus lines is unobservable, and you may of course use the address lines and bus lines in any scrambled order you please. However, the contents initializer breaks this symmetry; the address and bus lines are little-endian wrt the initializer. That is, ",Object(Z.jsx)("code",{children:"(contents[addr] >> bit) & 1"})," is the value you will see on ",Object(Z.jsx)("code",{children:"bus_out_nets[bit]"})," when ",Object(Z.jsx)("code",{children:"address_nets[i] == (addr >> i) & 1"})]})]})]})]})]})}}]),n}(s.a.PureComponent),re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),i(e),r(e),s(e),a(e)}))};o.a.render(Object(Z.jsx)(s.a.StrictMode,{children:Object(Z.jsx)(ie,{})}),document.getElementById("root")),re()}},[[36,1,2]]]);
//# sourceMappingURL=main.7fe1d3b6.chunk.js.map